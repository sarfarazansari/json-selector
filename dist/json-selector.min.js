/*!
 * jsonselector
 * 
 * Version: 0.0.1 - 2016-07-16T07:53:05.889Z
 * License: Apache-2.0
 */
"use strict";angular.module("jsonSelector",["RecursionHelper"]).provider("JSONSelectorConfig",function(){var e=!1,n=100,t=5,r=!1;return{get hoverPreviewEnabled(){return e},set hoverPreviewEnabled(n){e=!!n},get hoverPreviewArrayCount(){return n},set hoverPreviewArrayCount(e){n=parseInt(e,10)},get hoverPreviewFieldCount(){return t},set hoverPreviewFieldCount(e){t=parseInt(e,10)},get elementsSelectable(){return r},set elementsSelectable(e){r=e},$get:function(){return{hoverPreviewEnabled:e,hoverPreviewArrayCount:n,hoverPreviewFieldCount:t,elementsSelectable:r}}}}).service("$jsonSelector",[function(){var e=[],n=function(n,t){e.forEach(function(e){angular.isFunction(e)&&e(n,t)})};return{select:function(e){n("element.select",e)},deselect:function(e){n("element.deselect",e)},register:function(n){e.push(n)}}}]).directive("jsonSelector",["RecursionHelper","JSONSelectorConfig","$jsonSelector",function(e,n,t){function r(e){return e.replace('"','"')}function s(e){if(void 0===e)return"";if(null===e)return"Object";if("object"==typeof e&&!e.constructor)return"Object";var n=/function (.{1,})\(/,t=n.exec(e.constructor.toString());return t&&t.length>1?t[1]:""}function o(e){return null===e?"null":typeof e}function c(e,n){var t=o(e);return"null"===t||"undefined"===t?t:("string"===t&&(n='"'+r(n)+'"'),"function"===t?e.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{…}":n)}function i(e){var n="";return angular.isObject(e)?(n=s(e),angular.isArray(e)&&(n+="["+e.length+"]")):n=c(e,e),n}function l(e){e.isArray=function(){return angular.isArray(e.json)},e.isObject=function(){return angular.isObject(e.json)},e.getKeys=function(){if(e.isObject())return Object.keys(e.json).map(function(e){return""===e?'""':e})},e.type=o(e.json),e.hasKey="undefined"!=typeof e.key,e.getConstructorName=function(){return s(e.json)},"string"===e.type&&("Invalid Date"!==new Date(e.json).toString()&&(e.isDate=!0),0===e.json.indexOf("http")&&(e.isUrl=!0)),e.isEmptyObject=function(){return e.getKeys()&&!e.getKeys().length&&e.isOpen&&!e.isArray()},e.isOpen=!!e.open,e.toggleOpen=function(){e.isOpen=!e.isOpen},e.childrenOpen=function(){return e.open>1?e.open-1:0},e.openLink=function(n){n&&(window.location.href=e.json)},e.parseValue=function(n){return c(e.json,n)},e.showThumbnail=function(){return!!n.hoverPreviewEnabled&&e.isObject()&&!e.isOpen},e.getThumbnail=function(){if(e.isArray())return e.json.length>n.hoverPreviewArrayCount?"Array["+e.json.length+"]":"["+e.json.map(i).join(", ")+"]";var t=e.getKeys(),r=t.slice(0,n.hoverPreviewFieldCount),s=r.map(function(n){return n+":"+i(e.json[n])}),o=t.length>=5?"…":"";return"{"+s.join(", ")+o+"}"},e.elementsSelectable=function(){return!!n.elementsSelectable},e.isSelected=!!e.selected,e.toggleSelectElement=function(){var n=e,r=n.parent,s="";if(r&&r.json)do s=angular.isArray(r.json)?"["+n.key+"]"+s:"."+n.key+s,n=r,r=r.parent;while(void 0!==r);e.isSelected?(angular.isArray(e.model)&&e.model.splice(e.model.indexOf(s),1),t.deselect(s)):(angular.isArray(e.model)&&e.model.push(s),t.select(s)),e.isSelected=!e.isSelected}}return{templateUrl:"json-selector.html",restrict:"E",replace:!0,scope:{json:"=",key:"=",open:"=",parent:"=",model:"="},compile:function(n){return e.compile(n,l)}}}]),"object"==typeof module&&(module.exports="jsonSelector"),angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(n,t){angular.isFunction(t)&&(t={post:t});var r,s=n.contents().remove();return{pre:t&&t.pre?t.pre:null,post:function(n,o){r||(r=e(s)),r(n,function(e){o.append(e)}),t&&t.post&&t.post.apply(null,arguments)}}}}}]),angular.module("jsonSelector").run(["$templateCache",function(e){e.put("json-selector.html",'<div ng-init="isOpen = open && open > 0" class="json-selector-row"><input class="selector-checkbox" type="checkbox" ng-click="toggleSelectElement()" ng-if="elementsSelectable()"> <a ng-click="toggleOpen()"><span class="toggler {{isOpen ? \'open\' : \'\'}}" ng-if="isObject()"></span> <span class="key" ng-if="hasKey"><span class="key-text">{{key}}</span><span class="colon">:</span></span> <span class="value"><span ng-if="isObject()"><span class="constructor-name">{{getConstructorName(json)}}</span> <span ng-if="isArray()"><span class="bracket">[</span><span class="number">{{json.length}}</span><span class="bracket">]</span></span></span> <span ng-if="!isObject()" ng-click="openLink(isUrl)" class="{{type}}" ng-class="{date: isDate, url: isUrl}">{{parseValue(json)}}</span></span> <span ng-if="showThumbnail()" class="thumbnail-text">{{getThumbnail()}}</span></a><div class="children" ng-if="getKeys().length && isOpen"><json-selector ng-repeat="key in getKeys() track by $index" json="json[key]" key="key" open="childrenOpen()" parent="$parent" model="model"></json-selector></div><div class="children empty object" ng-if="isEmptyObject()"></div><div class="children empty array" ng-if="getKeys() && !getKeys().length && isOpen && isArray()"></div></div>')}]);